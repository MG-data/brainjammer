{
	"name": "Ch05Ex11",
	"properties": {
		"content": {
			"query": "SELECT COUNT(*) FROM brainwaves.FactREADING\n\nSELECT COUNT(*) AS distinct_row_count\nFROM (\n    SELECT DISTINCT *\n    FROM brainwaves.FactREADING\n) AS distinct_rows;\n\n--4539223\nSELECT COUNT(*)\nFROM brainwaves.FactREADING\nWHERE [VALUE] < 0.274 OR [VALUE] > 392\n--99278\n\nSELECT * INTO brainwaves.FactREADINGHighLow\nFROM brainwaves.FactREADING\nWHERE [VALUE] < 0.274 OR [VALUE] > 392  \nSELECT COUNT(*) FROM brainwaves.FactREADINGHighLow\n\n--99278\nDELETE FROM brainwaves.FactREADING WHERE [VALUE] < 0.274\nDELETE FROM brainwaves.FactREADING WHERE [VALUE] > 392\nSELECT COUNT(*) FROM brainwaves.FactREADING\n--4438073\n\n\nCREATE TABLE [brainwaves].[SCENARIO]\nWITH\n(\n  CLUSTERED COLUMNSTORE INDEX,\n  DISTRIBUTION = REPLICATE\n)\nAS\nSELECT DISTINCT SCENARIO,\n       AVG([VALUE]) OVER (partition by SCENARIO) as AVERAGE,\n       STDEV([VALUE]) OVER (partition by SCENARIO) as STANDARDDEV,\n       VAR([VALUE]) OVER (partition by SCENARIO) as VARIANCE,\n       PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO) as MEDIAN,\n       SQRT(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO)) AS SQUAREROOT,\n       SQUARE(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO)) AS SQUARED\nFROM brainwaves.FactREADING\nGO\nSELECT * FROM [brainwaves].[SCENARIO] ORDER BY SCENARIO\nGO\n\n\nCREATE TABLE [brainwaves].[ELECTRODE]\nWITH\n(\n  CLUSTERED COLUMNSTORE INDEX,\n  DISTRIBUTION = REPLICATE\n)\nAS\nSELECT DISTINCT ELECTRODE,\n       AVG([VALUE]) OVER (partition by ELECTRODE) as AVERAGE, \n       STDEV([VALUE]) OVER (partition by ELECTRODE) as STANDARDDEV,\n       VAR([VALUE]) OVER (partition by ELECTRODE) as VARIANCE,\n       PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by ELECTRODE) as MEDIAN,\n       SQRT(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by ELECTRODE)) AS SQUAREROOT,\n       SQUARE(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by ELECTRODE)) AS SQUARED\nFROM brainwaves.FactREADING\nGO\nSELECT * FROM [brainwaves].[ELECTRODE] ORDER BY ELECTRODE\nGO\n\n###\nCREATE TABLE [brainwaves].[FREQUENCY]\nWITH\n(\n  CLUSTERED COLUMNSTORE INDEX,\n  DISTRIBUTION = REPLICATE\n)\nAS\nSELECT DISTINCT FREQUENCY,\n       AVG([VALUE]) OVER (partition by FREQUENCY) as AVERAGE,\n       STDEV([VALUE]) OVER (partition by FREQUENCY) as STANDARDDEV,\n       VAR([VALUE]) OVER (partition by FREQUENCY) as VARIANCE,\n       PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by FREQUENCY) as MEDIAN,\n       SQRT(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by FREQUENCY)) AS SQUAREROOT,\n       SQUARE(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by FREQUENCY)) AS SQUARED\nFROM brainwaves.FactREADING\nGO\nSELECT * FROM [brainwaves].[FREQUENCY] ORDER BY FREQUENCY\nGO\n\n\n## \nCREATE TABLE [brainwaves].[SCENARIO_ELECTRODE]\nWITH\n(\n  CLUSTERED COLUMNSTORE INDEX,\n  DISTRIBUTION = REPLICATE\n)\nAS\nSELECT DISTINCT SCENARIO, ELECTRODE,\n       AVG([VALUE]) OVER (partition by SCENARIO, ELECTRODE) as AVERAGE, \n       STDEV([VALUE]) OVER (partition by SCENARIO, ELECTRODE) as STANDARDDEV,\n       VAR([VALUE]) OVER (partition by SCENARIO, ELECTRODE) as VARIANCE,\n       PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO, ELECTRODE) as MEDIAN,\n       SQRT(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO, ELECTRODE)) AS SQUAREROOT,\n       SQUARE(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO, ELECTRODE)) AS SQUARED\nFROM brainwaves.FactREADING\nGO\nSELECT * FROM [brainwaves].[SCENARIO_ELECTRODE] ORDER BY SCENARIO, ELECTRODE\nGO\n\n##\nCREATE TABLE [brainwaves].[SCENARIO_FREQUENCY]\nWITH\n(\n  CLUSTERED COLUMNSTORE INDEX,\n  DISTRIBUTION = REPLICATE\n)\nAS\nSELECT DISTINCT SCENARIO, FREQUENCY,\n       AVG([VALUE]) OVER (partition by SCENARIO, FREQUENCY) as AVERAGE,\n       STDEV([VALUE]) OVER (partition by SCENARIO, FREQUENCY) as STANDARDDEV,\n       VAR([VALUE]) OVER (partition by SCENARIO, FREQUENCY) as VARIANCE,\n       PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO, FREQUENCY) as MEDIAN,\n       SQRT(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO, FREQUENCY)) AS SQUAREROOT,\n       SQUARE(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO, FREQUENCY)) AS SQUARED\nFROM brainwaves.FactREADING\nGO\nSELECT * FROM [brainwaves].[SCENARIO_FREQUENCY] WHERE SCENARIO = 'TikTok' ORDER BY SCENARIO, FREQUENCY\nGO\n\n\n##\nCREATE TABLE [brainwaves].[SCENARIO_ELECTRODE_FREQUENCY]\nWITH\n(\n  CLUSTERED COLUMNSTORE INDEX,\n  DISTRIBUTION = REPLICATE\n)\nAS\nSELECT DISTINCT SCENARIO, ELECTRODE, FREQUENCY,\n       AVG([VALUE]) OVER (partition by SCENARIO, ELECTRODE, FREQUENCY) as AVERAGE,\n       STDEV([VALUE]) OVER (partition by SCENARIO, ELECTRODE, FREQUENCY) as STANDARDDEV,\n       VAR([VALUE]) OVER (partition by SCENARIO, ELECTRODE, FREQUENCY) as VARIANCE,\n       PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO, ELECTRODE, FREQUENCY) as MEDIAN,\n       SQRT(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO, ELECTRODE, FREQUENCY)) AS SQUAREROOT,\n       SQUARE(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY [VALUE]) OVER (partition by SCENARIO, ELECTRODE, FREQUENCY)) AS SQUARED\nFROM brainwaves.FactREADING\nGO\nSELECT * FROM [brainwaves].[SCENARIO_ELECTRODE_FREQUENCY] ORDER BY SCENARIO, ELECTRODE, FREQUENCY\n\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "SQLPool",
				"poolName": "SQLPool"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}